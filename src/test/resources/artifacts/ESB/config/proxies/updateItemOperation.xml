<?xml version="1.0" encoding="UTF-8"?>
<proxy xmlns="http://ws.apache.org/ns/synapse"
       name="updateItemOperation"
       transports="http https"
       startOnLoad="true">
   <description/>
   <target>
      <inSequence>
         <property name="uri.var.requestServerVersion"
                   expression="//RequestServerVersion/text()"
                   scope="default"
                   type="STRING"/>
         <property name="uri.var.mailboxCulture"
                   expression="//MailboxCulture/text()"
                   scope="default"
                   type="STRING"/>
         <property name="uri.var.smtpAddress"
                   expression="//SmtpAddress/text()"
                   scope="default"
                   type="STRING"/>
         <property name="uri.var.conflictResolution"
                   expression="//ConflictResolution/text()"
                   scope="default"
                   type="STRING"/>
         <property name="uri.var.messageDisposition"
                   expression="//MessageDisposition/text()"
                   scope="default"
                   type="STRING"/>
         <property name="uri.var.sendMeetingInvitationsOrCancellations"
                   expression="//SendMeetingInvitationsOrCancellations/text()"
                   scope="default"
                   type="STRING"/>
         <property name="uri.var.suppressReadReceipts"
                   expression="//SuppressReadReceipts/text()"
                   scope="default"
                   type="STRING"/>
         <property name="uri.var.distinguishedFolderId"
                   expression="//DistinguishedFolderId"
                   scope="default"
                   type="STRING"/>
         <property name="uri.var.addressListId"
                   expression="//AddressListId"
                   scope="default"
                   type="STRING"/>
         <property name="uri.var.folderId"
                   expression="//FolderId"
                   scope="default"
                   type="STRING"/>
         <property name="uri.var.itemChanges"
                   expression="//ItemChanges"
                   scope="default"
                   type="STRING"/>
         <ews.init>
            <endpointUrl>{get-property('system','EWS_ENDPOINT_URL')}</endpointUrl>
            <username>{get-property('system','EWS_ENDPOINT_USER_NAME')}</username>
            <password>{get-property('system','EWS_ENDPOINT_PASSWORD')}</password>
         </ews.init>
         <ews.updateItem>
            <requestServerVersion>{$ctx:uri.var.requestServerVersion}</requestServerVersion>
            <mailboxCulture>{$ctx:uri.var.mailboxCulture}</mailboxCulture>
            <smtpAddress>{$ctx:uri.var.smtpAddress}</smtpAddress>
            <messageDisposition>{$ctx:uri.var.messageDisposition}</messageDisposition>
            <folderId>{$ctx:uri.var.folderId}</folderId>
            <distinguishedFolderId>{$ctx:uri.var.distinguishedFolderId}</distinguishedFolderId>
            <addressListId>{$ctx:uri.var.addressListId}</addressListId>
            <conflictResolution>{$ctx:uri.var.conflictResolution}</conflictResolution>
            <itemChanges>{$ctx:uri.var.itemChanges}</itemChanges>
         </ews.updateItem>
         <respond/>
      </inSequence>
      <outSequence>
         <send/>
      </outSequence>
      <faultSequence>
         <send/>
      </faultSequence>
   </target>
</proxy>
